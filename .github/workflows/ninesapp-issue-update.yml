on:
  issues:
    types:
      - closed
  workflow_dispatch:

name: Create scheduled issue from template

jobs:
  build:
    if: contains(github.event.issue.user.login, 'dwivedine')
    runs-on: ubuntu-latest
    steps:
    # Get the title, labels, assignees, and body of the issue template at the path,
    # .github/ISSUE_TEMPLATE/my_template.md, if available.
    - uses: imjohnbo/extract-issue-template-fields@v1
      id: extract
      with:
        path: .github/ISSUE_TEMPLATE/incident.md

    # Create new issue with assignees, labels, title, and body
    - uses: imjohnbo/issue-bot@v3
      with:
        assignees: ${{ github.event.issue.assignees[0].login }}
        labels: ${{  github.event.issue.labels[0].name }}
        title: ${{  github.event.issue.title }} - Incident
        body: ${{ steps.extract.outputs.body }}
